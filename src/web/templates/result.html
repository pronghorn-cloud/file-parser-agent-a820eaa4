{% extends 'base.html' %}

{% block title %}Result - {{ filename }}{% endblock %}

{% block head %}
{% if is_markdown %}
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endif %}
<style>
    .result-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }
    
    .result-content {
        max-height: 70vh;
        overflow-y: auto;
    }
    
    .markdown-body {
        padding: 1rem;
        background: white;
        border-radius: 0.375rem;
    }
    
    .markdown-body h1, .markdown-body h2, .markdown-body h3 {
        margin-top: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    .markdown-body h1:first-child {
        margin-top: 0;
    }
    
    .markdown-body table {
        border-collapse: collapse;
        width: 100%;
        margin: 1rem 0;
    }
    
    .markdown-body th, .markdown-body td {
        border: 1px solid var(--border);
        padding: 0.5rem;
        text-align: left;
    }
    
    .markdown-body th {
        background: var(--bg);
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <div class="result-header">
        <h2>{{ filename }}</h2>
        <div>
            <a href="{{ url_for('download', filename=filename) }}" class="btn btn-primary">Download</a>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">Parse Another</a>
        </div>
    </div>
    
    <div class="result-content">
        {% if is_json %}
            <pre>{{ content }}</pre>
        {% elif is_markdown %}
            <div class="markdown-body" id="markdown-content"></div>
        {% else %}
            <pre>{{ content }}</pre>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
{% if is_markdown %}
<script>
    const content = {{ content | tojson }};
    document.getElementById('markdown-content').innerHTML = marked.parse(content);
</script>
{% endif %}
{% endblock %}
